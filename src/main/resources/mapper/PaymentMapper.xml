<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.aipms.mapper.PaymentMapper">

    <insert id="insertPayment" parameterType="com.aipms.domain.Payment" useGeneratedKeys="true" keyProperty="paymentId">
        INSERT INTO payment (
            entry_id, total_fee, payment_method, gateway, paid, cancelled, payment_time
        ) VALUES (
                     #{entryId}, #{totalFee}, #{paymentMethod}, #{gateway}, #{paid}, #{cancelled}, #{paymentTime}
                 )
    </insert>

    <select id="selectPaymentById" resultType="com.aipms.domain.Payment">
        SELECT * FROM payment WHERE payment_id = #{paymentId}
    </select>

    <select id="selectPaymentByEntryId" resultType="com.aipms.domain.Payment">
        SELECT * FROM payment WHERE entry_id = #{entryId}
    </select>


        <select id="getAccountInfo" resultType="com.aipms.dto.AccountInfoResponseDto">
            SELECT
                point,
                point_expire_next_month AS pointExpireNextMonth,
                prepaid_balance AS prepaidBalance,
                last_charged_at AS lastChargedAt,
                monthly_usage AS monthlyUsage,
                compare_last_month AS compareLastMonth
            FROM account_info
            WHERE member_id = #{memberId}
        </select>

</mapper>
